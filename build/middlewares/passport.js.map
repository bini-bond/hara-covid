{"version":3,"sources":["../../src/middlewares/passport.js"],"names":[],"mappings":"AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"passport.js","sourcesContent":["// import User from \"../author/model/user\";\n\n// export function authorize(role) {\n//   return async function(req, res, next) {\n//     const auth = await User.findByToken(req.body.param.token);\n//     if (auth) {\n//       if (auth.role === role){\n//         next(); return;\n//       }\n//       res.status(401);\n//       res.json({\n//         status: \"err\",\n//         result: {\n//           info: \"Unauthorized access\"\n//         }\n//       });\n//     } else {\n//       res.status(401);\n//       res.json({\n//         status: \"err\",\n//         result: {\n//           info: \"Unauthorized access\"\n//         }\n//       });\n//     }\n//   };\n// }\n"]}